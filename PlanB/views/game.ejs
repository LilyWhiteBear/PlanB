<%- include("partials/header") %>
<style>
    .flex-container {
      display: flex;
      flex-wrap: nowrap;
      background-color: White;
    }
    .flex-container > div {
      background-color: #f1f1f1;
      margin: 5px;
      padding: 3%;
      font-size: 50px;
    }
    h1{
        font-family: Courier New;
        font-size: 40px;
    }
    p{
        font-family: 'Nunito', sans-serif;
        font-size: 20px;
        font-style: normal;
        color: crimson;
        background-color: #F2F2F2;
        width:  400px;
    }
    sub{
        font-family: Courier New;
        font-size: 20px;
        color: crimson;
    }
    </style>
    
    </head>
    <body>
    
    
    <div class="container" style="text-align: center;">
        <h1>Tic-Tac-Toe<sub>  with Exusiai</sub></h1>
        <div class="row">
            <div class="col-md-12 col-lg-6">
                <div class="flex-container">
                    <div data-index="1" id="b" onclick="play(this)">&#160;&#160;</div>
                    <div data-index="2" id="b" onclick="play(this)">&#160;&#160;</div>
                    <div data-index="3" id="b" onclick="play(this)">&#160;&#160;</div> 
                </div>
                <div class="flex-container">
                    <div data-index="4" id="b" onclick="play(this)">&#160;&#160;</div>
                    <div data-index="5" id="b" onclick="play(this)">&#160;&#160;</div>
                    <div data-index="6" id="b" onclick="play(this)">&#160;&#160;</div> 
                </div>
                <div class="flex-container">
                    <div data-index="7" id="b" onclick="play(this)">&#160;&#160;</div>
                    <div data-index="8" id="b" onclick="play(this)">&#160;&#160;</div>
                    <div data-index="9" id="b" onclick="play(this)">&#160;&#160;</div> 
                </div>
                <p>Exusiai: Locked and loaded, ready for action!<p>
            </div>
            <div class="col-md-12 col-lg-6">
                <p>กติกา : 1. ชนะจะได้รับ 3 ชิ้นส่วน เสมอ 1 ชิ้นส่วน แพ้ไม่ได้อะไรเลย</p>
                <p>2. เล่นได้วันละ 1 ครั้ง และจะเล่นได้มากยิ่งขึ้นหากคุณมีระดับ VIP ที่สูงขึ้น</p>
                <p>เหลือจำนวนครั้งอีก <span id="proc">1</span> ครั้ง</p>
                <button type="button" class="btn btn-success float-left" id="starter" onclick="start()">เริ่มเกม</button>
            </div>
        </div>
        <div id="Exusiai" style="text-align: left;">
            <img src="https://yt3.ggpht.com/a/AGF-l7-kQXKejPQzKBZEYEcml0XtLrIlLkqneL2HnA=s900-c-k-c0xffffffff-no-rj-mo" height="150" weight="150" onclick="talk1()">
        </div>
    </div>
    
    </body>
    <script>
        var check = true;
        function start(){
            if(Number(document.querySelector("#proc").innerHTML) > 0){
                check = false;
                const box = document.querySelectorAll("#b");
                box[0].innerHTML = "&#160;&#160;";
                box[1].innerHTML = "&#160;&#160;";
                box[2].innerHTML = "&#160;&#160;";
                box[3].innerHTML = "&#160;&#160;";
                box[4].innerHTML = "&#160;&#160;";
                box[5].innerHTML = "&#160;&#160;";
                box[6].innerHTML = "&#160;&#160;";
                box[7].innerHTML = "&#160;&#160;";
                box[8].innerHTML = "&#160;&#160;";
                document.getElementById("starter").style.visibility = "hidden";
                document.querySelector("#proc").innerHTML = Number(document.querySelector("#proc").innerHTML) - 1;
            }
            else {
                alert("จำนวนครั้งหมด ไว้ลองใหม่คราวหน้านะ");
            }
        }
        function randomNumber(min, max) {  
            return Math.random() * (max - min) + min; 
        }  
        function talk1(){
            const rand = Math.floor(Math.random() * 4);
            if(rand === 0){
                const text = document.querySelector("p");
                text.innerHTML = "Exusiai: Apple pie!";
            }
            else if(rand === 1){
                const text = document.querySelector("p");
                text.innerHTML = "Exusiai: I'm lovin' this feeling!";
            }
            else if(rand === 2){
                const text = document.querySelector("p");
                text.innerHTML = "Exusiai: Let me create a diversion!";
            }
            else{
                const text = document.querySelector("p");
                text.innerHTML = "Exusiai: Rock n' roll!";
            }
        }
        function talk2(){
            const rand = Math.floor(Math.random() * 3);
            if(rand === 0){
                const text = document.querySelector("p");
                text.innerHTML = "Exusiai: Is it my turn?";
            }
            else if(rand === 1){
                const text = document.querySelector("p");
                text.innerHTML = "Exusiai: Yosh!";
            }
            else{
                const text = document.querySelector("p");
                text.innerHTML = "Exusiai: Yo!";
            }
        }
        function play(i){
            if(check === true){
                return;
            }
            if(i.innerHTML !== "X" && i.innerHTML !== "O"){
                i.innerHTML = "X";
            }
            else{ return; }
            const box = document.querySelectorAll("#b");
            if(box[0].innerHTML === "X" && box[1].innerHTML === "X" && box[2].innerHTML === "X" ||
            box[3].innerHTML === "X" && box[4].innerHTML === "X" && box[5].innerHTML === "X" ||
            box[6].innerHTML === "X" && box[7].innerHTML === "X" && box[8].innerHTML === "X" ||
            box[0].innerHTML === "X" && box[3].innerHTML === "X" && box[6].innerHTML === "X" ||
            box[1].innerHTML === "X" && box[4].innerHTML === "X" && box[7].innerHTML === "X" ||
            box[2].innerHTML === "X" && box[5].innerHTML === "X" && box[8].innerHTML === "X" ||
            box[0].innerHTML === "X" && box[4].innerHTML === "X" && box[8].innerHTML === "X" ||
            box[6].innerHTML === "X" && box[4].innerHTML === "X" && box[2].innerHTML === "X" ){
                const text = document.querySelector("p");
                text.innerHTML = "Exusiai: Wonderful! It's your victory, leader.";
                const r1 = Math.floor(randomNumber(0, 99));
                const r2 = Math.floor(randomNumber(0, 99));
                const r3 = Math.floor(randomNumber(0, 99));
                alert("ยินดีด้วย! คุณได้รับชิ้นส่วนสลาก 3 ชิ้น!\nชิ้นส่วน " + r1 + "!\nชิ้นส่วน " + r2 + "!\nชิ้นส่วน " + r3 + "!");
                check = true;
                return;
            }
            if((box[0].innerHTML === "X" || box[0].innerHTML === "O") &&
            (box[1].innerHTML === "X" || box[1].innerHTML === "O") &&
            (box[2].innerHTML === "X" || box[2].innerHTML === "O") &&
            (box[3].innerHTML === "X" || box[3].innerHTML === "O") &&
            (box[4].innerHTML === "X" || box[4].innerHTML === "O") &&
            (box[5].innerHTML === "X" || box[5].innerHTML === "O") &&
            (box[6].innerHTML === "X" || box[6].innerHTML === "O") &&
            (box[7].innerHTML === "X" || box[7].innerHTML === "O") &&
            (box[8].innerHTML === "X" || box[8].innerHTML === "O")){
                const text = document.querySelector("p");
                text.innerHTML = "Exusiai: Draw? Not bad at all.";
                const r1 = Math.floor(randomNumber(0, 99));
                alert("ยินดีด้วย! คุณได้รับชิ้นส่วนสลาก 1 ชิ้น!\nชิ้นส่วน " + r1 + "!");
                check = true;
                return;
            }
            if(box[4].innerHTML !== "X" && box[4].innerHTML !== "O"){
                box[4].innerHTML = "O"; talk1();
            }
            else{
                var defend = -1;
                for(var j = 1; j < box.length; j++){
                    if(box[j].innerHTML === box[j-1].innerHTML && j % 3 !== 0 && (box[j].innerHTML === "X" || box[j].innerHTML === "O")){
                        if(j % 3 === 1){ if(box[j+1].innerHTML !== "X" && box[j+1].innerHTML !== "O"){ 
                            if(box[j].innerHTML === "O") {box[j+1].innerHTML = "O"; defend = -1; break;}
                            else {defend = j+1;}
                        }}
                        else if(j % 3 === 2){ if(box[j-2].innerHTML !== "X" && box[j-2].innerHTML !== "O"){ 
                            if(box[j].innerHTML === "O") {box[j-2].innerHTML = "O"; defend = -1; break;}
                            else {defend = j-2;}
                        }}
                    }
                    if(j < 8) {if(box[j+1].innerHTML === box[j-1].innerHTML && j % 3 === 1 && (box[j-1].innerHTML === "X" || box[j-1].innerHTML === "O")){
                        if(box[j].innerHTML !== "X" && box[j].innerHTML !== "O"){ 
                            if(box[j+1].innerHTML === "O") {box[j].innerHTML = "O"; defend = -1; break; }
                            else {defend = j;}
                        }
                    }}
                    if(j > 2){ if(box[j].innerHTML === box[j-3].innerHTML && (box[j].innerHTML === "X" || box[j].innerHTML === "O")){
                        if(j > 5) { if(box[j-6].innerHTML !== "X" && box[j-6].innerHTML !== "O"){ 
                            if(box[j].innerHTML === "O") {box[j-6].innerHTML = "O"; defend = -1; break;}
                            else {defend = j-6;}
                        }} 
                        else if(j < 6){ if(box[j+3].innerHTML !== "X" && box[j+3].innerHTML !== "O"){ 
                            if(box[j].innerHTML === "O") {box[j+3].innerHTML = "O"; defend = -1; break;}
                            else {defend = j+3; }
                        }}
                    }}
                    if(j > 2 && j < 6){ if(box[j+3].innerHTML === box[j-3].innerHTML && (box[j+3].innerHTML === "X" || box[j+3].innerHTML === "O")){
                        if(box[j].innerHTML !== "X" && box[j].innerHTML !== "O"){ 
                            if(box[j+3].innerHTML === "O") {box[j].innerHTML = "O"; defend = -1; break;}
                            else {defend = j;}
                        }
                    }}
                    if(j === 4){
                        if(box[j+4].innerHTML === box[j].innerHTML && (box[j-4].innerHTML !== "X" && box[j-4].innerHTML !== "O")){
                            if(box[j].innerHTML === "O") {box[j-4].innerHTML = "O"; defend = -1; break;}
                            else {defend = j-4;}
                        }
                        if(box[j-4].innerHTML === box[j].innerHTML && (box[j+4].innerHTML !== "X" && box[j+4].innerHTML !== "O")){
                            if(box[j].innerHTML === "O") {box[j+4].innerHTML = "O"; defend = -1; break;}
                            else {defend = j+4;}
                        }
                        if(box[j+2].innerHTML === box[j].innerHTML && (box[j-2].innerHTML !== "X" && box[j-2].innerHTML !== "O")){
                            if(box[j].innerHTML === "O") {box[j-2].innerHTML = "O"; defend = -1; break;}
                            else {defend = j-2;}
                        }
                        if(box[j-2].innerHTML === box[j].innerHTML && (box[j+2].innerHTML !== "X" && box[j+2].innerHTML !== "O")){
                            if(box[j].innerHTML === "O") {box[j+2].innerHTML = "O"; defend = -1; break;}
                            else {defend = j+2;}
                        }
                    }
                    if(j === 8 && defend === -1){ 
                        for(;;){
                            const rand = Math.floor(Math.random() * 9);
                            if(box[rand].innerHTML !== "X" && box[rand].innerHTML !== "O"){
                                box[rand].innerHTML = "O"; talk1(); break;
                            }
                        }
                        break;
                    }
                }
                if(defend !== -1){
                    box[defend].innerHTML = "O";
                    defend = -1;
                    talk2();
                }
            }
            if(box[0].innerHTML === "O" && box[1].innerHTML === "O" && box[2].innerHTML === "O" ||
            box[3].innerHTML === "O" && box[4].innerHTML === "O" && box[5].innerHTML === "O" ||
            box[6].innerHTML === "O" && box[7].innerHTML === "O" && box[8].innerHTML === "O" ||
            box[0].innerHTML === "O" && box[3].innerHTML === "O" && box[6].innerHTML === "O" ||
            box[1].innerHTML === "O" && box[4].innerHTML === "O" && box[7].innerHTML === "O" ||
            box[2].innerHTML === "O" && box[5].innerHTML === "O" && box[8].innerHTML === "O" ||
            box[0].innerHTML === "O" && box[4].innerHTML === "O" && box[8].innerHTML === "O" ||
            box[6].innerHTML === "O" && box[4].innerHTML === "O" && box[2].innerHTML === "O" ){
                const text = document.querySelector("p");
                text.innerHTML = "Exusiai: GGEZ, leader.";
                check = true;
                return;
            }
        }
        </script>
<%- include("partials/footer") %>